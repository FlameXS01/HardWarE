
<!DOCTYPE html>
<html lang="en">
    
    {% load static %} 
    
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Focus - Bootstrap Admin Dashboard </title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'images/favicon.png' %}">
    <link href="{% static 'vendor/pg-calendar/css/pignose.calendar.min.css' %}" rel="stylesheet">
    <link href="{% static 'vendor/chartist/css/chartist.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <link href="{% static 'css/all.css' %}" rel="stylesheet">
</head>

<body>
    <div id="preloader">
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>

    <div id="main-wrapper">
        <div class="nav-header">
            <a href="{% url 'index' %}" class="brand-logo">
                <img class="logo-abbr" src="{% static 'images/logo.png' %}" alt="">
                <img class="logo-compact" src="{% static 'images/logo-text.png' %}" alt="">
                <img class="brand-title" src="{% static 'images/logo-text.png' %}" alt="">
            </a>
            <div class="nav-control">
                <div class="hamburger">
                    <span class="line"></span><span class="line"></span><span class="line"></span>
                </div>
            </div>
        </div>
        {%block navbarSuperior%}
        <div class="header">
            <div class="header-content">
                <nav class="navbar navbar-expand">
                    <div class="collapse navbar-collapse justify-content-between">
                        {%block buscar%}
                        <div class="header-left">
                            <div class="search_bar dropdown">
                                <span class="search_icon p-3 c-pointer" data-toggle="dropdown">
                                    <i class="mdi mdi-magnify"></i>
                                </span>                                
                                <div class="dropdown-menu p-0 m-0">
                                    <form>
                                        <input class="form-control" type="search" placeholder="Buscar" aria-label="Search">
                                    </form>
                                </div>
                            </div>
                        </div>
                        {%endblock%}
                        {%block notification%}
                        <ul class="navbar-nav header-right">
                            <li class="nav-item dropdown notification_dropdown">
                                <a class="nav-link" href="#" role="button" data-toggle="dropdown">
                                    <i class="mdi mdi-bell"></i>
                                    {% if pendientes %}
                                        <div class="pulse-css"></div>
                                    {% endif %}
                                </a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <ul class="list-unstyled">
                                        {% if pendientes %}
                                            {% for pendiente in pendientes %}
                                                <li class="media dropdown-item">
                                                    <div class="media-body">
                                                        <a href="{% url 'list_pendientes' %}">
                                                            <p><strong>{{ pendiente.id_pc.nombre_equipo }}</strong> tiene actualizaciones pendientes</p>
                                                        </a>
                                                    </div>
                                                    <span class="notify-time">{{ pendiente.fecha_pendiente }}</span>
                                                </li>
                                            {% endfor %}
                                        {% else %}
                                            <li class="media dropdown-item">
                                                <div class="media-body">
                                                    <p>No hay actualizaciones pendientes</p>
                                                </div>
                                            </li>
                                        {% endif %}
                                        <li class="dropdown-item text-center">
                                            <a href="{% url 'list_pendientes' %}" class="text-primary">
                                                Ver todas las actualizaciones pendientes
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav-item dropdown header-profile">
                                <a href="{% static 'app-profile.html' %}" class="dropdown-item">
                                    <i class="mdi mdi-account"></i>
                                </a>
                            </li>
                        </ul>
                        {%endblock%}
                    </div>
                </nav>
            </div>
        </div>
        {%endblock%}
        <div class="quixnav">
            <div class="quixnav-scroll">
                
                <ul class="metismenu" id="menu">
                    <!-- Menú Principal -->        
                    <li class="nav-label first">Utilidades</li>   
                <!-- Expedientes -->
                    <li>
                        <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">
                            <i class="icon icon-folder"></i><span class="nav-text">Expedientes</span>
                        </a>
                        <ul aria-expanded="false">
                            <!-- Submenú UEB -->
                            <li>
                                <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">
                                    <i class="icon icon-globe"></i><span class="nav-text">UEB</span>
                                </a>
                                <ul aria-expanded="false">
                                    <li><a href="{% url 'list_Ueb_exp' %}">Listar Expedientes</a></li>
                                </ul>
                            </li>                     

                            <!-- Submenú Complejos -->

                            <li>
                                <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">
                                    <i class="icon icon-building"></i><span class="nav-text">Complejos</span>
                                </a>
                                <ul aria-expanded="false">
                                    <li><a href="{% url 'list_Complejo_exp' %}">Listar Expedientes</a></li>
                                </ul>
                            </li>
                            <!-- Submenú Otros -->

                            <li>
                                <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">
                                    <i class="icon icon-building"></i><span class="nav-text">Otros</span>
                                </a>
                                <ul aria-expanded="false">
                                    <li><a href="{% url 'list_Otros_exp' %}">Listar Expedientes</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>

                    <!-- Gestionar Entidades -->        
                    <li>       
                        <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">        
                            <i class="icon icon-grid"></i><span class="nav-text">Gestionar Entidades</span>        
                        </a>        
                        <ul aria-expanded="false">        
                            <li><a href="{% url 'list_entidad' %}">Listar Todas</a></li>  
                            <li><a href="{% url 'list_Complejo' %}">Listar Complejos</a></li>
                            <li><a href="{% url 'list_Ueb' %}">Listar Ueb</a></li>      
                            <li><a href="{% url 'add_entidad' %}">Agregar Entidad</a></li>        
                        </ul>        
                    </li>     
        
                    <!-- Detalles Hardware -->
        
                    <li>        
                        <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">        
                            <i class="icon icon-cpu"></i><span class="nav-text">Detalles Hardware</span>        
                        </a>       
                        <ul aria-expanded="false">        
                            <li><a href="{% url 'list_pc' %}">Pc</a></li>        
                            <li><a href="{% url 'list_chasis' %}">Chasis</a></li>        
                            <li><a href="{% url 'list_periferico' %}">Periféricos</a></li>        
                            <li><a href="{% url 'list_fuente' %}">Fuentes</a></li>        
                            <li><a href="{% url 'list_almacenamiento' %}">Almacenamiento</a></li>        
                            <li><a href="{% url 'list_procesador' %}">Procesadores</a></li>        
                            <li><a href="{% url 'list_placa' %}">Placas Base</a></li>        
                            <li><a href="{% url 'list_ram' %}">Tarjetas Ram</a></li>        
                            <li><a href="{% url 'list_lector' %}">Lectores</a></li>        
                            <li><a href="{% url 'list_ranura' %}">Ranuras Expansión</a></li>        
                            <li><a href="{% url 'list_tarjeta' %}">Tarjeta Red </a></li>        
                        </ul>        
                    </li>        
        
                    <!-- Incidencias -->
        
                    <li>        
                        <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">        
                            <i class="icon icon-folder"></i><span class="nav-text">Incidencias</span>        
                        </a>        
                        <ul aria-expanded="false">  
                            <li><a href="{% url 'list_incidencia' %}">Todas las Incidencias</a></li>        
                            <li><a href="{% url 'add_incidencia' %}">Agregar Incidencia</a></li>        
                            <li>
                                <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">
                                    <i class="icon icon-folder"></i><span class="nav-text">Entidades</span>
                                </a>
                                <ul aria-expanded="false">
                                    <!-- Submenú UEB -->
                                    <li>
                                        <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">
                                            <i class="icon icon-globe"></i><span class="nav-text">UEB</span>
                                        </a>
                                        <ul aria-expanded="false">
                                            <li><a href="{% url 'get_incidencias_por_ueb' %}">Listar Incidencias</a></li>
                                        </ul>
                                    </li>                     
                    
                                    <!-- Submenú Complejos -->
                                    <li>
                                        <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">
                                            <i class="icon icon-building"></i><span class="nav-text">Complejos</span>
                                        </a>
                                        <ul aria-expanded="false">
                                            <li><a href="{% url 'get_incidencias_por_complejo' %}">Listar Incidencias</a></li>
                                        </ul>
                                    </li>
                    
                                    <!-- Submenú Otros -->
                                    <li>
                                        <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">
                                            <i class="icon icon-building"></i><span class="nav-text">Otros</span>
                                        </a>
                                        <ul aria-expanded="false">
                                            <li><a href="{% url 'get_incidencias_otros' %}">Listar Incidencias</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>        
                    </li>
        
                    <!-- Reportes -->        
                    <li>        
                        <a class="has-arrow" href="javascript:void(0)" aria-expanded="false">        
                            <i class="icon icon-file-text"></i><span class="nav-text">Reportes</span>        
                        </a>
                        <ul aria-expanded="false">
                            <li><a href="{% url 'reportes_pcs_por_entidad' %}">PCs por Entidad</a></li>
                            <li><a href="{% url 'reportes_cap_discos_por_entidad' %}">Discos y capacidades</a></li>
                            <li><a href="{% url 'reportes_ram_por_entidad' %}">Rams y capacidades</a></li>
                            <li><a href="{% url 'reportes_modelos_board_por_entidad' %}">Modelos Board  </a></li>
                            <li><a href="{% url 'reportes_pcs_por_entidad' %}">PCs por Entidad</a></li>
        
                        </ul>
        
                    </li>
        
                </ul>

            </div>
        </div>
        {%block content%}
        <div class="content-body">
        <div class="container-fluid">
                {%block welcome%}
                <div class="row page-titles mx-0">
                    <div class="col-sm-6 p-md-0">
                        <div class="welcome-text">
                            <h4>Hi, welcome back!</h4>
                            <p class="mb-0">Your business dashboard template</p>
                        </div>
                    </div>
                    <div class="col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="javascript:void(0)">Layout</a></li>
                            <li class="breadcrumb-item active"><a href="javascript:void(0)">Blank</a></li>
                        </ol>
                    </div>
                </div>
                {%endblock%}
                {%block detalles%}
                <div class="row">
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="stat-widget-one card-body">
                                
                                    
                                        <i class="fas fa-desktop"></i> 
                                    
                                
                                <div class="stat-content d-inline-block">
                                    <div class="stat-text">Ordenadores</div>
                                    <div class="stat-digit">{{cont}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% comment %} <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="stat-widget-one card-body">
                                <div class="stat-content d-inline-block">
                                    <div class="col-lg-3 col-sm-6">
                                        <div class="card">
                                            <div>
                                                <div class="stat-content d-inline-block">
                                                    <div class="stat-text">Sistemas Operativos</div>
                                                    <div class="d-flex justify-content-between mt-2">
                                                        <div class="text-center">
                                                            <i class="fab fa-windows fa-2x"></i> <!-- Ícono para Windows 10 -->
                                                            <div class="font-weight-bold">Win 10: 112</div>
                                                        </div>
                                                        <div class="text-center">
                                                            <i class="fab fa-windows fa-2x"></i> <!-- Ícono para Windows 11 -->
                                                            <div class="font-weight-bold">Win 11: 11</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> {% endcomment %}
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="stat-widget-one card-body">
                                <div class="stat-icon d-inline-block">
                                    <i class="ti-layout-grid2 text-pink border-pink"></i>
                                </div>
                                <div class="stat-content d-inline-block">
                                    <div class="stat-text">Projects</div>
                                    <div class="stat-digit">770</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="stat-widget-one card-body">
                                <div class="stat-icon d-inline-block">
                                    <i class="ti-link text-danger border-danger"></i>
                                </div>
                                <div class="stat-content d-inline-block">
                                    <div class="stat-text">Referral</div>
                                    <div class="stat-digit">2,781</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {%endblock%}
                {%block grafico%}
                <div class="row">
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="card h-100">
                                <div class="card-header">
                                    <h4 class="card-title">Cantidad de PCs por Entidad</h4>
                                </div>
                                <div class="card-body">
                                    <canvas id="pcsPorEntidadChart" class="w-100"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="card h-100">
                                <div class="card-header">Cantidad de Modelos de Placas</div>
                                <div class="card-body">
                                    <canvas id="modelosPlacasChart" class="w-100"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 mt-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title"> Distribución de Discos y Capacidades por Entidad</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="capacidadesDiscosChart" style="height: 400px;"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <script>
                    // Gráfico de barras: Cantidad de PCs por Entidad
                    const ctx1 = document.getElementById('pcsPorEntidadChart').getContext('2d');
                    new Chart(ctx1, {
                        type: 'bar',
                        data: {
                            labels: {{ entidades_labels|safe }},
                            datasets: [{
                                label: 'Cantidad de PCs',
                                data: {{ entidades_values|safe }},
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.5)',
                                    'rgba(54, 162, 235, 0.5)',
                                    'rgba(255, 206, 86, 0.5)',
                                    'rgba(75, 192, 192, 0.5)',
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                        }
                    });

                    // Gráfico de pastel: Cantidad de Modelos de Placas
                    const ctx2 = document.getElementById('modelosPlacasChart').getContext('2d');
                    new Chart(ctx2, {
                        type: 'pie',
                        data: {
                            labels: {{ placas_labels|safe }},
                            datasets: [{
                                data: {{ placas_values|safe }},
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.5)',
                                    'rgba(54, 162, 235, 0.5)',
                                    'rgba(255, 206, 86, 0.5)',
                                    'rgba(75, 192, 192, 0.5)',
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                        }
                    });

                    // Gráfico de capacidades apiladas
                    const capacidadesChart = new Chart(
                        document.getElementById('capacidadesDiscosChart').getContext('2d'),
                        {
                            type: 'bar',
                            data: {
                                labels: {{ discos_apilados_labels|safe }},
                                datasets: {{ discos_apilados_datasets|safe }}
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                scales: {
                                    x: { stacked: true },
                                    y: { 
                                        stacked: true,
                                        title: {
                                            display: true,
                                            text: 'Cantidad de Discos'
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        position: 'bottom',
                                        labels: { boxWidth: 12 }
                                    }
                                }
                            }
                        }
                    );
                </script>
                {%endblock%}
                {%block table%}
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Detalles de equipos operativos</h4>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    
                                <!-- Tabla de PCs -->
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Nombre del Equipo</th>
                                                <th>Sistema Operativo</th>
                                                <th>Último Reporte</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for pc in pcs %}
                                            <tr>
                                                <td>{{ pc.id_pc }}</td>
                                                <td>{{ pc.nombre_equipo }}</td>
                                                <td>{{ pc.so }}</td>
                                                <td>{{ pc.ultimo_reporte }}</td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>

                                    <!-- Botones -->
                                    <div class="d-flex justify-content-between mt-4">
                                        <a href="{% url 'list_pc' %}" class="btn btn-primary">
                                            <i class="fas fa-info-circle"></i> Ver Más Detalles
                                        </a>
                                        <a href="{% url 'add_pc' %}" class="btn btn-success">
                                            <i class="fas fa-plus-circle"></i> Agregar PC
                                        </a>
                                    </div>

                                </div>
                                {%endblock%}
                            </div>
                        </div>
                    </div>
                    {%block notifications%}
                    {% block Timeline %}
                    <div class="col-lg-6 col-xl-4 col-xxl-6 col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Timeline</h4>
                            </div>
                            <div class="card-body">
                                <div class="widget-timeline">
                                    <ul class="timeline">
                                        {% for pendiente in pendientes_recientes %}
                                        <li>
                                            <div class="timeline-badge {% if pendiente.estado == 'PENDIENTE' %}warning{% elif pendiente.estado == 'APLICADO' %}success{% else %}danger{% endif %}"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <span>{{ pendiente.fecha_pendiente|date:"H:i A" }}</span>
                                                <h6 class="m-t-5">{{ pendiente.id_pc.nombre_equipo }} - {{ pendiente.estado }}</h6>
                                            </a>
                                        </li>
                                        {% empty %}
                                        <li>
                                            <div class="timeline-badge dark"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <span>Ahora</span>
                                                <h6 class="m-t-5">No hay nada en cambios recientes.</h6>
                                            </a>
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endblock %}
                    {%block Incidencias%}
                    <div class="col-xl-4 col-lg-6 col-xxl-6 col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Incidencias Recientes</h4>
                            </div>
                            <div class="card-body">
                                <div class="recent-comment m-t-15">
                                    {% for incidencia in incidencias %}
                                    <div class="media">
                                        <div class="media-left">
                                            <a href="#"><img class="media-object mr-3" src="{% static 'images/avatar/4.png' %}" alt="..."></a>
                                        </div>
                                        <div class="media-body">
                                            <h4 class="media-heading text-primary">{{ incidencia.id_pc.nombre }}</h4>
                                            <p><strong>Observación:</strong> {{ incidencia.observacion }}</p>
                                            <p class="comment-date">Fecha: {{ incidencia.fecha_incidencia }}</p>
                                        </div>
                                    </div>
                                    {% empty %}
                                    <div class="media">
                                        <div class="media-body">
                                            <p>No hay incidencias registradas.</p>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                                <div class="mt-3">

                                    <a href="{% url 'list_incidencia' %}" class="btn btn-info">Mostrar Todas las Incidencias</a>                    
                                    <a href="{% url 'add_incidencia' %}" class="btn btn-primary">Agregar Nueva Incidencia</a>
                    
                                </div>
                            </div>
                        </div>
                    </div>
                    {%endblock%}
                    <div class="col-xl-4 col-xxl-6 col-lg-6 col-md-12 col-sm-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Todo</h4>
                            </div>
                            <div class="card-body px-0">
                                <div class="todo-list">
                                    <div class="tdl-holder">
                                        <div class="tdl-content widget-todo2 mr-4">
                                            <ul id="todo_list">
                                                <li><label><input type="checkbox"><i></i><span>Get up</span><a href='#'
                                                            class="ti-trash"></a></label></li>
                                                <li><label><input type="checkbox" checked><i></i><span>Stand up</span><a
                                                            href='#' class="ti-trash"></a></label></li>
                                                <li><label><input type="checkbox"><i></i><span>Don't give up the
                                                            fight.</span><a href='#' class="ti-trash"></a></label></li>
                                                <li><label><input type="checkbox" checked><i></i><span>Do something
                                                            else</span><a href='#' class="ti-trash"></a></label></li>
                                                <li><label><input type="checkbox" checked><i></i><span>Stand up</span><a
                                                            href='#' class="ti-trash"></a></label></li>
                                                <li><label><input type="checkbox"><i></i><span>Don't give up the
                                                            fight.</span><a href='#' class="ti-trash"></a></label></li>
                                            </ul>
                                        </div>
                                        <div class="px-4">
                                            <input type="text" class="tdl-new form-control" placeholder="Write new item and hit 'Enter'...">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            <div class="card">
                                <div class="card-body">
                                    <div class="year-calendar"></div>
                                </div>
                            </div>
                            <!-- /# card -->
                        </div>
                        
                    </div>
                    {%endblock%}
                
                
                </div>
                {%endblock%}
        <div class="footer">
            <div class="copyright">
                <p>Copyright &copy; Designed &amp; Developed by <a href="#" target="_blank">Quixkit</a> 2019</p>
            </div>
        </div>

        </div>

    <script src="{% static 'vendor/global/global.min.js' %}"></script>
    <script src="{% static 'js/quixnav-init.js' %}"></script>
    <script src="{% static 'js/custom.min.js' %}"></script>

    <script src="{% static 'vendor/chartist/js/chartist.min.js' %}"></script>

    <script src="{% static 'vendor/moment/moment.min.js' %}"></script>
    <script src="{% static 'vendor/pg-calendar/js/pignose.calendar.min.js' %}"></script>

    <script src="{% static 'js/dashboard/dashboard-2.js' %}"></script>
</body>

</html>